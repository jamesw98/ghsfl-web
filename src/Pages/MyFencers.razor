@page "/my-fencers"
@using GhsflUtils.Models
@using GhsflUtils.Services
@using GhsflUtils.Enums

@inject FencerService FencerService

<AuthorizeView>
    <NotAuthorized>
        <NotAuthorizedMessage/>
    </NotAuthorized>
    <Authorized>
        @if (_myFencers != null)
        {
            <MudContainer MaxWidth="MaxWidth.Large">
                <MudPaper Class="pa-4">
                    <MudText Typo="Typo.h5">Men</MudText>
                    <MudTable Items="_myFencers.Where(f => f.Gender == Genders.Male)"
                              Breakpoint="Breakpoint.Md"
                              Context="men">
                        <HeaderContent>
                            <MudTh>Firstname</MudTh>
                            <MudTh>Lastname</MudTh>
                            <MudTh>Points</MudTh>
                        </HeaderContent>
                        <RowTemplate>
                            <MudTh>@men.FirstName</MudTh>
                            <MudTh>@men.LastName</MudTh>
                            <MudTh>@(men.Points ?? 0)</MudTh>
                        </RowTemplate>
                    </MudTable>
                    <br/>
                    <MudText Typo="Typo.h5">Women</MudText>
                    <MudTable Items="_myFencers.Where(f => f.Gender == Genders.Female)"
                              Breakpoint="Breakpoint.Md"
                              Context="women">
                        <HeaderContent>
                            <MudTh>Firstname</MudTh>
                            <MudTh>Lastname</MudTh>
                            <MudTh>Points</MudTh>
                        </HeaderContent>
                        <RowTemplate>
                            <MudTh>@women.FirstName</MudTh>
                            <MudTh>@women.LastName</MudTh>
                            <MudTh>@(women.Points ?? 0)</MudTh>
                        </RowTemplate>
                    </MudTable>
                </MudPaper>
            </MudContainer>
        }
        else
        {
            <MudContainer MaxWidth="MaxWidth.Large">
                <MudPaper Class="pa-4">
                    <MudProgressCircular Color="Color.Primary"/>
                </MudPaper>
            </MudContainer>
        }
    </Authorized>
</AuthorizeView>

@code {

    private List<Fencer>? _myFencers;

    protected override async Task OnInitializedAsync()
    {
        _myFencers = await FencerService.GetFencersForUser();
    }

}